<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Simple application using an Elix component</title>
  <script type="module" src="./node_modules/elix/define/ComboBox.js"></script>
  <script type="module">
    window.onload = init;

    function init() {
      const search = document.querySelector('.search-track');
      search.input.addEventListener('input', onSearchInputChange);
    }

    function onSearchInputChange(e) {
      const value = e.target.value;
      searchForTrackOnDeezer(value);
    }

    async function searchForTrackOnDeezer(filter) {
      const params = new URLSearchParams({ limit: 15, q: filter });

      const res = await fetch(`https://api.deezer.com/search?${params}`);
      const json = await res.json();
      const matchingTracks = json.data.map(({title_short, artist}) => `${artist.name} - ${title_short}`);
      const uniqueMatchingTracks = [...new Set(matchingTracks)];
      console.log(uniqueMatchingTracks);
    }
  </script>

  <style>
    body {
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-size: 15px;
    }
  </style>

</head>

<body>
  <elix-combo-box class="search-track">Empty</elix-combo-box>
</body>

</html>
